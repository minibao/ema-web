function checkmobile(e){var a="请输入正确的手机号码或邮箱";if(""==e)return layer.msg(a),!1;var t=/^1\d{10}$/,o=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;if(t.test(e)||o.test(e)){if(t.test(e)){if(11!=e.length)return layer.msg(a),!1;type="mobile"}else type="email";return!0}return layer.msg(a),!1}var flag=!1,type="phone";$(document).ready(function(){var e=util.getUrlParams("uid"),a=util.getUrlParams("server"),t=util.getUrlParams("source");$("#btn_bind_phone").click(function(){var o=$("#txt_mobile").val(),s=$("#txt_code").val();if($("#loadingToast").show(),!checkmobile(o))return $("#loadingToast").hide(),!1;var l={},i="/pf/ema-platform/member/bindAccount";l="mobile"==type?{accountType:1,mobile:o,uid:e,captcha:s}:{accountType:2,email:o,uid:e,captcha:s},$.ajax({url:i,type:"post",dataType:"json",data:l,error:function(){$("#loadingToast").hide(),layer.msg("请求失败！")},success:function(o){$("#loadingToast").hide(),0==o.status?(layer.msg(o.message),location.href="/users/info?uid="+e+"&server="+a+"&source="+t):layer.msg(o.message)}})});var o=60;$("#getmsgyzm").click(function(){var e=$("#txt_mobile").val();if($("#loadingToast").show(),!checkmobile(e))return $("#loadingToast").hide(),!1;var a={},t="";if("mobile"==type?(t="/pf/ema-platform/notice/sendCaptcha",a={mobile:e}):(t="/pf/ema-platform/notice/sendEmailCaptcha",a={email:e}),60==o){$("#mfyz").html(o+"S"),$(".btn_dxyzm").addClass("btn_dxyzm_60s");var s=setInterval(function(){o--,$("#mfyz").html(o+"S"),0==o&&(clearInterval(s),$("#mfyz").html("重新发送"),$(".btn_dxyzm").removeClass("btn_dxyzm_60s"),o=60)},1e3);$.ajax({url:t,type:"post",dataType:"json",data:a,error:function(){$("#loadingToast").hide(),layer.msg("请求失败！")},success:function(e){$("#loadingToast").hide(),layer.msg(e.message)}})}else layer.msg("请求时间过短！"),$("#loadingToast").hide()}),$(".menulist").on("click","#getmsgyzmnew",function(){var e=$("#txt_mobile").val();if($("#loadingToast").show(),!checkmobile(e))return $("#loadingToast").hide(),!1;if(60==o){$("#mfyz").html(o+"S"),$(".btn_dxyzm").addClass("btn_dxyzm_60s");var a=setInterval(function(){o--,$("#mfyz").html(o+"S"),0==o&&(clearInterval(a),$("#mfyz").html("重新发送"),$(".btn_dxyzm").removeClass("btn_dxyzm_60s"),o=60)},1e3),e=$("#txt_mobile").val();$.ajax({url:"/pf/ema-platform/notice/sendCaptcha",type:"post",dataType:"json",data:{mobile:e},error:function(){$("#loadingToast").hide(),layer.msg("请求失败！")},success:function(e){layer.msg(e.message),$("#loadingToast").hide()}})}else layer.msg("请求时间过短！"),$("#loadingToast").hide()})});