var app=new Vue({el:"#app",data:{accountId:"",binfo:"",prize10:"",boxId:"",prizeList:"",lotteryType:"",uid:"",uinfo:""},methods:{getuserinfo:function(){app.accountId&&$.ajax({type:"POST",url:"/api/active_getinfo",data:{accountId:app.accountId},success:function(a){try{app.binfo=a.data}catch(t){}}})},getuserdata:function(){app.uid&&$.ajax({type:"POST",url:"/api/userdata",data:{uid:app.uid},success:function(a){try{console.log(a),app.uinfo=a.data}catch(t){}}})},chooseTicket:function(){$("#commonTicket").click(function(){var a=$(this).hasClass("box-shadow1");a?$(this).removeClass("box-shadow1"):($("#seniorTicket").removeClass("box-shadow1"),$(this).addClass("box-shadow1"),app.lotteryType="1")}),$("#seniorTicket").click(function(){var a=$(this).hasClass("box-shadow1");a?$(this).removeClass("box-shadow1"):($("#commonTicket").removeClass("box-shadow1"),$(this).addClass("box-shadow1"),app.lotteryType="2")})},getlrecentlylist_10:function(){$.ajax({type:"POST",url:"/api/geTenWinningList",data:{},success:function(a){try{app.prize10=a.data,$("#scrollmessage ul").html("");for(var t="",e=0;e<app.prize10.length;e++)t=t+'<li><p><span class="sever"> 平台的 </span><span class="name"> 同学'+e+' </span> 抽到 <span class="jiang"> '+app.prize10[e].prizeName+' </span> <span class="gang">'+app.prize10[e].time+"</span></p></li>";$("#scrollmessage ul").html(t)}catch(o){}}})},btntoggle:function(){$(".gainingmask .gbtn").click(function(){$(".gainingmask").hide()})},startPrize:function(){var a=window.h;window.click=!0,$("#gbtn").click(function(){if($(".gainingmask").hide(),!click)return console.log("点击被屏蔽"),!1;var t=$(".quan").hasClass("box-shadow1");if(!t)return alert("请先选择一张券！"),window.click=!1,setTimeout(function(){window.click=!0},3e3),!1;if(isBegin)return!1;if(isBegin=!0,1==app.lotteryType){var e=$("#commonno").html();if("0张"==e)return $("body").unbind("touchmove"),alert("该类型的券已经用完！"),!1}if(2==app.lotteryType){var o=$("#seniorno").html();if(console.log(o),"0张"==o)return $("body").unbind("touchmove"),alert("该类型的券已经用完！"),!1}$(".frm").animate({scrollTop:1e3},500),$(".num").css("backgroundPositionY",0),$.ajax({type:"POST",url:"/api/startQuotaShake ",data:{accountId:app.accountId},success:function(t){try{console.log(t);var e=t.data.personalQuota;console.log(e);var o=Math.floor(100*e),n=o.toString();if(n.length<5){for(var i=n.length;i<5;i++)n="0"+n;o=n}var s=(o+"").split("");$(".num").each(function(t){var o=$(".num").eq(4-t);console.log(o),setTimeout(function(){o.animate({backgroundPositionY:60*a-a*s[4-t]},{duration:6e3+3e3*t,easing:"easeInOutCirc",complete:function(){4==t&&(window.click=!0,isBegin=!1,console.log(e),e&&($("#prizedot").html(e.toFixed(2)),$(".gainingmask").show(),app.getuserinfo(),app.getlrecentlylist_10()))}})},30*t)})}catch(c){}}})})}}});app.uid=sessionStorage.getItem("uid"),app.uid&&app.getuserdata(),app.accountId=sessionStorage.getItem("accountId_shequ"),app.boxId="3",app.getuserinfo(),app.getuserdata(),app.getlrecentlylist_10(),app.chooseTicket(),app.btntoggle();var isBegin=!1;$(function(){app.startPrize()});